@page "/login"
@inject NavigationManager Navigation
@inject IHttpContextAccessor HttpContextAccessor

<h3>Login</h3>

<div id="telegram-login-widget"></div>

<script async src="https://telegram.org/js/telegram-widget.js?7" data-telegram-login="makefoxbot" data-size="large" data-auth-url="https://admin.makefox.bot/api/auth/telegram")" data-request-access="write"></script>

@if (!string.IsNullOrEmpty(LoginError))
{
    <p style="color: red">@LoginError</p>
}

@code {

    //@Navigation.ToAbsoluteUri("/api/auth/telegram")

    private string LoginError;

    protected override async Task OnInitializedAsync()
    {
        var userSession = HttpContextAccessor.HttpContext.Session.GetString("UserSession");
        if (!string.IsNullOrEmpty(userSession))
        {
            await InvokeAsync(() => Navigation.NavigateTo("/"));
        }
    }
}
